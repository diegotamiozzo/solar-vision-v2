üìä Integra√ß√£o com Google Sheets

O formul√°rio envia automaticamente os dados inseridos pelo usu√°rio para uma planilha do Google Sheets, utilizando um Google Apps Script configurado como uma API p√∫blica.

üîß Passo a Passo de Configura√ß√£o

1. Crie uma nova planilha
   - Acesse https://sheets.google.com
   - Crie uma planilha nova (exemplo: "Simulador Solar")
   - Crie uma aba nova ("Respostas"), mesmo nome da function

2. Abra o editor de script
   - No menu superior, clique em: Extens√µes ‚Üí Apps Script

3. Cole o seguinte c√≥digo no editor:
   ----------------------------------------------------------
function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Respostas");
  
  if (!sheet) {
    sheet = SpreadsheetApp.getActiveSpreadsheet().insertSheet("Respostas");
    sheet.appendRow(["Installation Type", "Location", "Installation Location", "Energy Provider", "Energy Type", "Monthly Bill", "Name", "Email", "Phone", "Privacy Agreement"]);
  }

  var data = JSON.parse(e.postData.contents);
  sheet.appendRow([
    data.installationType,
    data.location,
    data.installationLocation,
    data.energyProvider,
    data.energyType,
    data.monthlyBill,
    data.name,
    data.email,
    data.phone,
    data.privacyAgreement ? "Yes" : "No"
  ]);
  
  return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
}
   ----------------------------------------------------------

4. Implante como aplicativo da web
   - Clique em Implantar ‚Üí Nova implanta√ß√£o
   - Em ‚ÄúTipo de implanta√ß√£o‚Äù, escolha Aplicativo da Web
   - Em ‚ÄúExecutar como‚Äù, selecione Voc√™ mesmo
   - Em ‚ÄúQuem tem acesso‚Äù, escolha Qualquer pessoa
   - Clique em Implantar e copie a URL p√∫blica gerada (exemplo):
     https://script.google.com/macros/s/AKfycbzSeuCodigoAqui/exec

5. Configure o endpoint no c√≥digo do formul√°rio
   - No arquivo script.js, substitua a URL na fun√ß√£o enviarParaPlanilha():
     ----------------------------------------------------------
     fetch("https://script.google.com/macros/s/AKfycbzSeuCodigoAqui/exec", {
         method: "POST",
         mode: "no-cors",
         headers: {
             "Content-Type": "application/json"
         },
         body: JSON.stringify(sheetData)
     });
     ----------------------------------------------------------

6. Teste o envio
   - Preencha e envie o formul√°rio completo
   - Acesse sua planilha no Google Sheets
   - Verifique se as informa√ß√µes foram registradas automaticamente na aba ‚ÄúRespostas‚Äù
